# ------------------------------------------------------------------------------
# <auto-generated>
#
#     This code was generated.
#
#     - To turn off auto-generation set:
#
#         [OurGitHubActions (AutoGenerate = false)]
#
#     - To trigger manual generation invoke:
#
#         nuke --generate-configuration GitHubActions_continuous --host GitHubActions
#
# </auto-generated>
# ------------------------------------------------------------------------------

# This workflow is generated by the nuke configuration on mitch-capper/httrack-windows. It runs on the main httrack repo however.
env:
  NUKE_TELEMETRY_OPTOUT: 1
name: continuous

on:
  push:
    branches-ignore:
      - trash

jobs:
  continuous:
    name: Run
    runs-on: ${{matrix.BaseImage}}
    strategy:
      matrix:
        BaseImage: [windows-latest, ubuntu-latest, ubuntu-18.04]
        Configuration: [Debug, Release]
        Arch: [x86, x64]
        exclude:
          - Arch: x86
            BaseImage: ubuntu-latest
          - Arch: x86
            BaseImage: ubuntu-18.04
    env:
      NUKE_BaseImage: ${{matrix.BaseImage}}
      NUKE_Configuration: ${{matrix.Configuration}}
      NUKE_Arch: ${{matrix.Arch}}
    steps:
      - uses: actions/checkout@v2
        with:
          submodules: recursive
          fetch-depth: 0
          repository: mitchcapper/httrack-windows
      - name: Cache .nuke/temp, ~/.nuget/packages
        uses: actions/cache@v2
        with:
          path: |
            .nuke/temp
            ~/.nuget/packages
          key: ${{ runner.os }}-${{ hashFiles('**/global.json', '**/*.csproj') }}
      - name: Run './build.cmd Pack'
        run: ./build.cmd Pack
      - uses: actions/upload-artifact@v1
        with:
          name: httrack-${{matrix.BaseImage}}-${{matrix.Configuration}}-${{matrix.Arch}}
          path: final
